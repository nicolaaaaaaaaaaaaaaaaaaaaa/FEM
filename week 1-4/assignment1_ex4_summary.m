%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Raw data %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% V_con = 8;
% rho_min = 10^-6;
% max_iopt = 100;
% p = 1.5;
% eps = 10^-8;
% eta = 0.99;
% 
% 3by4
% last C
%      3.073765992601978e-04
% 
% % 3by4_all
% last C
%      2.925907315631312e-04
%

% % 5by4
% last C
%      3.200848464107341e-04
% 
% % 5by4_all
% last C
%      2.570412910770580e-04
% 

% % 9by7
% last C
%      2.708306212817123e-04
% 
% % 9by7_all
% last C
%      2.622777052715254e-04
% 

% % 17by13
% last C
%      4.083069347314601e-04
% % 17by13_all
% last C
%      2.272240249219025e-04


% % 33by13
% last C
%      4.609825452504953e-04
% 
% % 33by13_all
% last C
%      2.221576476174534e-04


% 9by7_all with changing p

% p = 1,                      C = 1.709746470414343e-04, internal rho = 2.461916696834469e+00, intermediate = 212, 
% p = 1.100000000000000e+00   C = 2.333910874519611e-04, internal rho = 1.222000141102987e+00, intermediate = 247,
% p = 1.200000000000000e+00   C = 2.180648702397532e-04, internal rho = 1.554122755398698e+00, intermediate = 66,
% p = 1.300000000000000e+00   C = 2.491635469645087e-04, internal rho = 1.479864333355276e-01, intermediate = 6,
% p = 1.400000000000000e+00   C = 2.500863388599038e-04, internal rho = 8.498925416403984e-01, intermediate = 12,
% p = 1.500000000000000e+00   C = 2.622777052715254e-04, internal rho = 1.476768026938349e+00, intermediate = 5,
% p = 1.600000000000000e+00   C = 2.303695191930346e-04, internal rho = 1.172169515154041e+00, intermediate = 3,
% p = 1.700000000000000e+00   C = 2.430982791389462e-04, internal rho = 1.458236051344280e+00, intermediate = 4,
% p = 1.800000000000000e+00   C = 4.000489085006948e-04, internal rho = 2.944720441971276e-01, intermediate = 3,
% p = 1.900000000000000e+00   C = 4.006615950920616e-04, internal rho = 3.934849361070566e-01, intermediate = 22,
% p = 2                       C = 2.115983239743828e-04, internal rho = 6.491663098115975e-01, intermediate = 16,


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Elaboration %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

C =     [3.073765992601978e-04, 3.200848464107341e-04, 2.708306212817123e-04, 4.083069347314601e-04, 4.609825452504953e-04];
C_all = [2.925907315631312e-04, 2.570412910770580e-04, 2.622777052715254e-04, 3.442854107124029e-04, 3.221576476174534e-04];

x = 1:length(C);

p = [1,1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2];
C2 = [   1.709746470414343e-04,
        2.333910874519611e-04,
        2.180648702397532e-04,
        2.491635469645087e-04,
        2.500863388599038e-04,
        2.622777052715254e-04,
        2.303695191930346e-04,
        2.430982791389462e-04,
        4.000489085006948e-04,
        4.006615950920616e-04,
        2.115983239743828e-04];
rho =   [2.461916696834469e+00,
        1.222000141102987e+00,
        1.554122755398698e+00,
        1.479864333355276e-01,
        8.498925416403984e-01,
        1.476768026938349e+00,
        1.172169515154041e+00,
        1.458236051344280e+00,
        2.944720441971276e-01,
        3.934849361070566e-01,
        6.491663098115975e-01];

intermediate = [212,
                247,
                66,
                6,
                12,
                5,
                3,
                4,
                3,
                22,
                16];

figure

plot(x,C, 'b-', x,C_all, 'c-' ,'LineWidth', 2);
ylabel('Compliance')
xticks([1 2 3 4 5])
xticklabels({'3by4','5by4','9by7','17by13','33by13'})
legend('comp-neighbor', 'comp-all','location','north','FontSize',15)


figure
yyaxis left
plot(p,C2, 'b-', 'LineWidth', 2)
ylabel('Compliance')

yyaxis right
semilogy(p,intermediate, 'r-', 'LineWidth', 2)
ylabel('intermediate elements (log)')
xlabel('p')
legend('compliance', 'intermediate elements', 'Location','north','FontSize',15)


